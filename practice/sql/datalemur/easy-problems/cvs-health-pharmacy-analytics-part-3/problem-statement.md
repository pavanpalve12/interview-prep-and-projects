------------------------------------------------------------------------
title: Cvs Health Pharmacy Analytics Part 3
platform: datalemur
id: cvs-health-pharmacy-analytics-part-3
slug: cvs-health-pharmacy-analytics-part-3
difficulty: easy
time_taken_minutes: 9
attempts: 6
solved_date: 2025-11-21
author: pavanpalve12
------------------------------------------------------------------------
# Problem Statement

## Objective
CVS Health wants deeper insight into the total drug sales generated by each manufacturer so this information can be displayed on an executive dashboard.

Write a SQL query to:
- Calculate **total sales per manufacturer**
- Convert the result to **millions**, rounded to the nearest whole million
- Format the output as: `"$36 million"`
- Sort the results:
  1. **Descending** by total sales  
  2. **Alphabetically** by manufacturer name if totals are tied

Output the following columns:
- `manufacturer`
- `sale` (formatted string)

---

## Table: `pharmacy_sales`

| Column Name  | Type     |
|--------------|----------|
| product_id   | integer  |
| units_sold   | integer  |
| total_sales  | decimal  |
| cogs         | decimal  |
| manufacturer | varchar  |
| drug         | varchar  |

### Example Input

| product_id | units_sold | total_sales  | cogs        | manufacturer | drug             |
|------------|------------|--------------|-------------|--------------|------------------|
| 94         | 132362     | 2041758.41   | 1373721.70  | Biogen       | UP and UP        |
| 9          | 37410      | 293452.54    | 208876.01   | Eli Lilly    | Zyprexa          |
| 50         | 90484      | 2521023.73   | 2742445.90  | Eli Lilly    | Dermasorb        |
| 61         | 77023      | 500101.61    | 419174.97   | Biogen       | Varicose Relief  |
| 136        | 144814     | 1084258.00   | 1006447.73  | Biogen       | Burkhart         |

---

## Example Output

| manufacturer | sale        |
|--------------|-------------|
| Biogen       | $4 million  |
| Eli Lilly    | $3 million  |

---

## Explanation
- **Biogen**  
  Total sales = 2,041,758.41 + 500,101.61 + 1,084,258.00  
  = **3,626,118.02** → **$4 million** (rounded)

- **Eli Lilly**  
  Total sales = 293,452.54 + 2,521,023.73  
  = **2,814,476.27** → **$3 million** (rounded)

These values are then displayed in descending order of sales.
